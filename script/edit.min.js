function UA_onChangePoints(e,t){userPremium=e;if(userPremium){if($(".analytics_option").find("input").length===0)createAnalyticsOption();else showAnalyticsOption()}else hideAnalyticsOption()}function createAnalyticsOption(){var e=$(".analytics_option"),t=$("<input>").attr("type","checkbox").appendTo(e);if(!_notifyBarJson.configs.allow_widget_tracking||_notifyBarJson.configs.allow_widget_tracking&&_notifyBarJson.configs.allow_widget_tracking==="true")t.attr({checked:"checked",value:"true"});else t.attr("value","false");t.off("click").on("click",function(){_notifyBarJson.configs.allow_widget_tracking=this.checked;$(this).attr("value",this.checked?"true":"false");if(this.checked){$(this).attr({checked:"checked",value:"true"})}else{$(this).removeAttr("checked").attr("value","false")}saveAnalyticsOption(this.checked)});$("<label>").html("Allow widget tracking").appendTo(e).off("click").on("click",function(){if($(this).prev().attr("checked")){$(this).prev().removeAttr("checked").attr("value","false");_notifyBarJson.configs.allow_widget_tracking=false;saveAnalyticsOption(false)}else{$(this).prev().attr({checked:"checked",value:"true"});_notifyBarJson.configs.allow_widget_tracking=true;saveAnalyticsOption(true)}});$("<div>").addClass("c-mini-tooltip-ico").appendTo(e).tooltip({content:"All embed codes include Google Analytics by default. We use Google Analytics to monitor widget's performance and to improve its functionality. Uncheck this option if you get any conflict between your website Analytics code and NotifySnack Analytics code or if you don't want your widget to be tracked by us.",width:"300"});if(userPremium)showAnalyticsOption()}function showAnalyticsOption(){$(".analytics_option").css("display","block")}function hideAnalyticsOption(){$(".analytics_option").empty().css("display","none");saveAnalyticsOption(false)}function saveAnalyticsOption(e){$.ajax({type:"POST",cache:false,data:{hash:notify.hash,page:"save-analytics-option",awt:e},error:function(){},success:function(e){}})}function initWidget(){_notifyBarWidget=new NotifySnack;reloadWidget()}function reloadWidget(){_notifyBarWidget.init({hash:notify.hash,target:"wrapper",callback:function(e){_notifyBarJson=e;if(userPremium){if($(".analytics_option").find("input").length===0)createAnalyticsOption();else showAnalyticsOption()}var t=false;if(_notifyBarJson.configs.params.theme==="custom"){if(!_notifyBarJson.configs.params.customValues){t=true;var n={configs:{params:{}}};if(_notifyBarJson.configs.params.backgroundType)n.configs.params.backgroundType=_notifyBarJson.configs.params.backgroundType;if(_notifyBarJson.configs.params.backgroundColor)n.configs.params.backgroundColor=_notifyBarJson.configs.params.backgroundColor;if(_notifyBarJson.configs.params.backgroundGradient)n.configs.params.backgroundGradient=_notifyBarJson.configs.params.backgroundGradient;if(_notifyBarJson.configs.params.backgroundTone)n.configs.params.backgroundTone=_notifyBarJson.configs.params.backgroundTone;if(_notifyBarJson.configs.params.messageColor)n.configs.params.messageColor=_notifyBarJson.configs.params.messageColor;if(_notifyBarJson.configs.params.linkColor)n.configs.params.linkColor=_notifyBarJson.configs.params.linkColor;if(_notifyBarJson.configs.params.itemFontFamily)n.configs.params.itemFontFamily=_notifyBarJson.configs.params.itemFontFamily;if(_notifyBarJson.configs.params.itemFontSize)n.configs.params.itemFontSize=_notifyBarJson.configs.params.itemFontSize;if(_notifyBarJson.configs.params.itemFontStyle)n.configs.params.itemFontStyle=_notifyBarJson.configs.params.itemFontStyle;if(_notifyBarJson.configs.params.textShadow)n.configs.params.textShadow=_notifyBarJson.configs.params.textShadow;if(_notifyBarJson.configs.params.itemRounded)n.configs.params.itemRounded=_notifyBarJson.configs.params.itemRounded;if(_notifyBarJson.configs.params.barStyle)n.configs.params.barStyle=_notifyBarJson.configs.params.barStyle;if(_notifyBarJson.configs.params.barSymbol)n.configs.params.barSymbol=_notifyBarJson.configs.params.barSymbol;if(_notifyBarJson.configs.params.itemBorder)n.configs.params.itemBorder=_notifyBarJson.configs.params.itemBorder;if(_notifyBarJson.configs.params.itemShadow)n.configs.params.itemShadow=_notifyBarJson.configs.params.itemShadow;_notifyBarJson.configs.params.customValues=n.configs.params}$.userApi.cookie("notificationBar_customValues",JSON.stringify(_notifyBarJson.configs.params.customValues))}_themeModule=new configuratorFormTheme;_themeModule.setConfiguratorData(_notifyBarJson);if(t)_themeModule.postThemeData(_notifyBarJson,true);updateOnItemBottomSelection();openDisplayRules();createDisplayRulesTooltip()}})}function redrawWidget(){if(_notifyBarJson){_notifyBarWidget.redraw(_notifyBarJson)}else{alert("Invalid widget object.");_notifyBarWidget.redraw({})}updateOnItemBottomSelection()}function removeWidget(){if(_notifyBarWidget){_notifyBarWidget.destroy();delete _notifyBarWidget;_notifyBarWidget=null}}function createLiveWidget(){_liveNotifyBarWidget=new NotifySnack;_liveNotifyBarWidget.init({hash:notify.hash,target:"inner",preview:true,id:"notifySnackLive-"+notify.hash})}function removeLiveWidget(){if(_liveNotifyBarWidget){_liveNotifyBarWidget.destroy();delete _liveNotifyBarWidget;_liveNotifyBarWidget=null}}function disableCheckBox(e){var t=$(document).find("#customize_form");var n=t.find("#itemButton");var r=t.find("#itemBtnCollapse");var i=n.next().width()+32;var s=$("<a/>").attr({href:"#",ttid:"tt4"}).addClass("c-mini-tooltip-icon").css({left:i+"px",right:"auto"});if(e=="disable"){n.attr("disabled","disabled").removeAttr("checked").next().addClass("disabled").append(s);s.tooltip({content:"Option not available with Twitter messages",className:"c-tooltip",width:180});r.attr("disabled","disabled").removeAttr("checked").next().addClass("disabled")}else{n.removeAttr("disabled").next().removeClass("disabled").find(".c-mini-tooltip-icon").remove();r.removeAttr("disabled").next().removeClass("disabled").find(".c-mini-tooltip-icon").remove()}}function createDisplayRulesTooltip(){$(function(){$("#itemDisplayRulesSubtitle").find(".c-mini-tooltip-icon").tooltip({tooltipClass:"c-tooltip",content:"Check this option if you want to show this notification bar only on specific pages of your website. This is a powerful option that allows you to embed multiple notification bars on your website and show them only when defined URL rules are fulfilled. Leave this option unchecked if you want to display the notification bar on all the pages where it will be embedded.",width:"400"})})}function updateOnItemBottomSelection(){var e=document.getElementById("itemPushing");var t=document.getElementById("itemOntop");if(_notifyBarJson.configs.params.itemBottom==="true"){if(_notifyBarJson.configs.template_name!=="Sharp"){e.removeAttribute("checked");e.setAttribute("disabled","disabled")}t.setAttribute("checked","checked");t.setAttribute("disabled","disabled")}else{if(_notifyBarJson.configs.template_name!=="Sharp"){e.removeAttribute("disabled")}t.removeAttribute("disabled");t.removeAttribute("checked")}}function getElementsByClassName(e,t,n){var r=t=="*"&&e.all?e.all:e.getElementsByTagName(t);var i=new Array;n=n.replace(/-/g,"-");var s=new RegExp("(^|s)"+n+"(s|$)");var o;for(var u=0;u<r.length;u++){o=r[u];if(s.test(o.className)){i.push(o)}}return i}function openDisplayRules(){if(_notifyBarJson.configs.displayRulesFlag!=="true"){}else{if(!document.getElementById("itemDisplayRulesContainer")){var e=document.getElementById("displayRulesFlag");e.checked="true";var t=document.createElement("div");t.setAttribute("id","itemDisplayRulesContainer");t.className="row clearfix input_checkbox";var n=document.getElementById("itemDisplayRulesSubtitle");var r=document.getElementById("displayRules");r.appendChild(t);var i=document.createElement("div");i.setAttribute("id","itemDisplayRuleNewLine");i.style.clear="both";i.style.fontSize="12px";i.style.paddingTop="7px";i.innerHTML='<a href="javascript:insertDisplayRuleLine();" class="advanced">+ Add new rule</a>';i.style.cursor="pointer";i.className="itemDisplayRuleNewLine";t.appendChild(i);for(var s in _notifyBarJson.display_rules){if(_notifyBarJson.display_rules.hasOwnProperty(s)){reCreateDisplayRuleLines(s,_notifyBarJson.display_rules[s].ruleCondition,_notifyBarJson.display_rules[s].ruleTarget,_notifyBarJson.display_rules[s].ruleType)}}assignId("itemDisplayRulesContainer","itemDisplayRuleLineContainer","itemDisplayRuleLineContainer");var o;var t=document.getElementById("itemDisplayRulesContainer");for(var u=0;u<t.childNodes.length;u++){if(t.childNodes[u].className=="itemDisplayRuleLineContainer"){for(var a=0;a<t.childNodes[u].childNodes.length;a++){if(t.childNodes[u].childNodes[a].className=="itemDisplayRuleDeleteLine"&&t.childNodes.length>2){t.childNodes[u].childNodes[a].innerHTML='<a onclick="javascript:deleteDisplayRuleLine(this);" class="advanced">Delete rule</a>'}}}}}}}function insertElementAfterElement(e,t){e.parentNode.insertBefore(t,e.nextSibling)}function assignId(e,t,n){var r=document.getElementById(e);for(var i=0;i<r.childNodes.length;i++){if(r.childNodes[i].className==t){r.childNodes[i].id=n+i;for(var s=0;s<r.childNodes[i].childNodes.length;s++){if(r.childNodes[i].childNodes[s].name=="itemDisplayRuleCondition")r.childNodes[i].childNodes[s].id="itemDisplayRuleCondition"+i;else if(r.childNodes[i].childNodes[s].name=="itemDisplayRuleTarget")r.childNodes[i].childNodes[s].id="itemDisplayRuleTarget"+i;else if(r.childNodes[i].childNodes[s].name=="itemDisplayRuleType")r.childNodes[i].childNodes[s].id="itemDisplayRuleType"+i}}}}function disableDisplayRuleType(){itemDisplayRulesContainer=document.getElementById("itemDisplayRulesContainer");var e;e=itemDisplayRulesContainer.childNodes.length;e--;if(itemDisplayRulesContainer.childNodes.length<=2){$(".itemDisplayRuleType").css("display","none")}if(itemDisplayRulesContainer.childNodes.length>2){$(".itemDisplayRuleType.selectBox-dropdown").css("display","inline-block");$("#itemDisplayRuleNewLine").prev().find(".itemDisplayRuleType").css("display","none")}}function createDisplayRuleLine(){var e=document.getElementById("itemDisplayRulesContainer");var t=document.getElementById("itemDisplayRulesSubtitle");var n=document.getElementById("itemDisplayRuleNewLine");if(e.childNodes.length<11){var r=document.createElement("div");r.setAttribute("id","itemDisplayRuleLineContainer");r.className="itemDisplayRuleLineContainer";r.style.cssFloat="left";r.style.marginTop="5px";r.style.marginBottom="0px";r.innerHTML='<select name="itemDisplayRuleCondition" id="itemDisplayRuleCondition" class="selectBox itemDisplayRuleCondition" style="width: 180px; height: 25px; display: block; float:left; margin-top:8px;"><option value="1">URL contains</option><option value="2">URL equals</option><option value="3">URL starts with</option><option value="4">URL ends with</option><option value="5">URL does not contain</option><option value="6">URL does not equal</option><option value="7">URL does not start with</option><option value="8">URL does not end with</option><option value="9">Matches RegEx</option></select><input type="text" id="itemDisplayRuleTarget" name="itemDisplayRuleTarget" class="itemDisplayRuleTarget" style="width:200px; height:27px; vertical-align:middle; display: block; margin-top:5px; margin-left:20px; float:left; text-algin:center; border:1px #c5c5c5 solid; padding-left:10px; padding-right:10px;"><select name="itemDisplayRuleType" id="itemDisplayRuleType" class="selectBox itemDisplayRuleType" style="width: 55px; height: 25px; display: block; float:left; margin-top:8px; margin-left:20px !important;"><option value="1">or</option><option value="2">and</option></select><div id="itemDisplayRuleDeleteLine" class="itemDisplayRuleDeleteLine" style="margin-top: 12px; margin-left: 20px; font-size: 12px; float: left; cursor: pointer;"></div>';e.insertBefore(r,n);$(document).ready(function(){$(".itemDisplayRuleCondition").selectBox();$(".itemDisplayRuleType").selectBox();$(".itemDisplayRuleCondition").css("float","left");$("a.itemDisplayRuleType").css("float","left");$("span.selectBox-label").css("color","#575757")});r.childNodes[4].style.setProperty("margin-left","20px","important");r.childNodes[4].style.setProperty("margin-top","8px","important");r.childNodes[4].style.setProperty("width","55px","important")}disableDisplayRuleType();if(e.childNodes.length==11)n.childNodes[0].style.display="none"}function setMyOption(e,t){var n=document.getElementById(e);var r=n.options;for(var i=0,s=r.length;i<s;i++){if(r[i].value==t){n.selectedIndex=i;return true}}return false}function reCreateDisplayRuleLines(e,t,n,r){var i=document.createElement("div");i.setAttribute("id","itemDisplayRuleLineContainer");i.className="itemDisplayRuleLineContainer";i.style.cssFloat="left";i.style.marginTop="5px";i.style.marginBottom="0px";i.innerHTML='<select name="itemDisplayRuleCondition" id="itemDisplayRuleCondition'+e+'" class="selectBox itemDisplayRuleCondition" style="width: 180px; height: 25px; display: block; float:left; margin-top:8px;"></select><input type="text" id="itemDisplayRuleTarget" name="itemDisplayRuleTarget" class="itemDisplayRuleTarget" style="width: 200px; height:27px; vertical-align:middle; display: block; margin-top:5px; margin-left:20px; float:left; text-algin:center; border:1px #c5c5c5 solid; padding-left:10px; padding-right:10px;" value="'+n+'"><select name="itemDisplayRuleType" id="itemDisplayRuleType'+e+'" class="selectBox itemDisplayRuleType" style="width: 55px; height: 25px; display: block; float:left; margin-top:8px; margin-left:20px !important;"></select><div id="itemDisplayRuleDeleteLine" class="itemDisplayRuleDeleteLine" style="margin-top: 12px; margin-left: 20px; font-size: 12px; float: left; cursor: pointer;"></div>';var s="";var o;var u;var a;var f;var l;var c;var h;var p;var d;var v;for(var m=1;m<=9;m++){switch(m){case 1:if(m==t){u='<option value="1" selected="selected">URL contains</option>';break}else{u='<option value="1">URL contains</option>';break};case 2:if(m==t){a='<option value="2" selected="selected">URL equals</option>';break}else{a='<option value="2">URL equals</option>';break};case 3:if(m==t){f='<option value="3" selected="selected">URL starts with</option>';break}else{f='<option value="3">URL starts with</option>';break};case 4:if(m==t){l='<option value="4" selected="selected">URL ends with</option>';break}else{l='<option value="4">URL ends with</option>';break};case 5:if(m==t){c='<option value="5" selected="selected">URL does not contain</option>';break}else{c='<option value="5">URL does not contain</option>';break};case 6:if(m==t){h='<option value="6" selected="selected">URL does not equal</option>';break}else{h='<option value="6">URL does not equal</option>';break};case 7:if(m==t){p='<option value="7" selected="selected">URL does not start with</option>';break}else{p='<option value="7">URL does not start with</option>';break};case 8:if(m==t){d='<option value="8" selected="selected">URL does not end with</option>';break}else{d='<option value="8">URL does not end with</option>';break};case 9:if(m==t){v='<option value="9" selected="selected">Matches RegEx</option>';break}else{v='<option value="9">Matches RegEx</option>';break};default:o="";break}}s=u+a+f+l+c+h+p+d+v;var g="";var y;var b;var w;if(r==="1"){b='<option value="1" selected="selected">or</option>';w='<option value="2">and</option>'}else if(r==="2"){b='<option value="1">or</option>';w='<option value="2" selected="selected">and</option>'}g=b+w;var E=document.getElementById("itemDisplayRulesSubtitle");var S=document.getElementById("itemDisplayRulesContainer");var x=document.getElementById("itemDisplayRuleNewLine");S.insertBefore(i,x);var T=document.getElementById("itemDisplayRuleCondition"+e);T.innerHTML=s;var N=document.getElementById("itemDisplayRuleType"+e);N.innerHTML=g;$(document).ready(function(){$(".itemDisplayRuleCondition").selectBox();$(".itemDisplayRuleType").selectBox();$(".itemDisplayRuleCondition").css("float","left");$("a.itemDisplayRuleType").css("float","left");$("span.selectBox-label").css("color","#575757")});i.childNodes[4].style.setProperty("margin-left","20px","important");i.childNodes[4].style.setProperty("margin-top","8px","important");i.childNodes[4].style.setProperty("width","55px","important");i.childNodes[4].style.setProperty("float","left","important");disableDisplayRuleType()}function createDisplayRules(){if($("#displayRulesFlag").hasClass("inProgress")){return}else{var e=document.getElementById("displayRulesFlag");if(_notifyBarJson.configs.displayRulesFlag!=="true"){$("#displayRulesFlag").addClass("inProgress");$("#displayRulesFlag").attr("disabled",true);e.checked="true";var t=document.createElement("div");t.setAttribute("id","itemDisplayRulesContainer");t.className="row clearfix input_checkbox";var n=document.getElementById("itemDisplayRulesSubtitle");var r=document.getElementById("displayRules");r.appendChild(t);var i=document.createElement("div");i.setAttribute("id","itemDisplayRuleNewLine");i.style.clear="both";i.style.fontSize="12px";i.style.paddingTop="7px";i.innerHTML='<a href="javascript:insertDisplayRuleLine();" class="advanced">+ Add new rule</a>';i.style.cursor="pointer";i.className="itemDisplayRuleNewLine";t.appendChild(i);createDisplayRuleLine();assignId("itemDisplayRulesContainer","itemDisplayRuleLineContainer","itemDisplayRuleLineContainer");_notifyBarJson.configs.displayRulesFlag="true";$("#displayRulesFlag").removeClass("inProgress");$("#displayRulesFlag").removeAttr("disabled")}else if(_notifyBarJson.configs.displayRulesFlag==="true"){_notifyBarJson.configs.displayRulesFlag="false";e.checked=="false";itemDisplayRulesGrandContainer=document.getElementById("displayRules");t=document.getElementById("itemDisplayRulesContainer");itemDisplayRulesGrandContainer.removeChild(t);rulesDeleteAll()}}}function insertDisplayRuleLine(){createDisplayRuleLine();assignId("itemDisplayRulesContainer","itemDisplayRuleLineContainer","itemDisplayRuleLineContainer");var e;var t=document.getElementById("itemDisplayRulesContainer");for(var n=0;n<t.childNodes.length;n++){if(t.childNodes[n].className=="itemDisplayRuleLineContainer"){for(var r=0;r<t.childNodes[n].childNodes.length;r++){if(t.childNodes[n].childNodes[r].className=="itemDisplayRuleDeleteLine"){t.childNodes[n].childNodes[r].innerHTML='<a onclick="javascript:deleteDisplayRuleLine(this);" class="advanced">Delete rule</a>'}}}}}function deleteDisplayRuleLine(e){var t=e.parentNode.parentNode;var n=document.getElementById("itemDisplayRulesContainer");var r=document.getElementById("itemDisplayRuleNewLine");var i=t.id.replace(/[^\d.]/g,"");if(n.childNodes.length>2){t.parentNode.removeChild(t)}assignId("itemDisplayRulesContainer","itemDisplayRuleLineContainer","itemDisplayRuleLineContainer");if(n.childNodes.length<11&&r.childNodes[0].style.display=="none"){r.childNodes[0].style.display="block"}if(n.childNodes.length<3){$("#itemDisplayRulesContainer").find(".itemDisplayRuleLineContainer").find("#itemDisplayRuleDeleteLine").empty()}disableDisplayRuleType();ruleRemover()}function getDisplayRulesData(){var e=$("#itemDisplayRulesContainer");var t={};var n={};e.find(".itemDisplayRuleLineContainer").each(function(e,t){var r=e;n[r]={ruleCondition:$("#itemDisplayRuleCondition"+r).val(),ruleTarget:$("#itemDisplayRuleTarget"+r).val(),ruleType:$("#itemDisplayRuleType"+r).val()}});$.extend(t,n);return t}function getCurrentRuleContent(e){return}function myPreviewPreloader(e){var t=e.width(),n=e.height();e.find(".loading").remove();e.css({position:"relative",textAlign:"center"}).width(t).height(n).empty().append($("<img />").addClass("loading").css({position:"absolute",left:(t-16)/2,top:(n-32)/2}).attr({src:"/images/loading.gif",width:32,height:32}))}function BufferRotator(e){function f(){e.width=e.height=32;r.translate(16,16);r.rotate(a+=.12);++u;r.rotate(u*Math.PI/6);for(var t=0;t<12;t++){r.globalAlpha=t/12;r.save();r.fillStyle="rgba(0, 0, 0, 0.2)";c(r,4,-2,12,6,4);r.restore();r.save();r.fillStyle="rgba(0, 0, 0, 0.2)";c(r,5,-1,10,4,4);r.restore();r.save();r.fillStyle="#fff";l(r,6,0,8,2);r.restore();r.transform(o,s,-s,o,0,0)}r.restore()}function l(e,t,n,r,i){e.fillRect(t,n,r,i)}function c(e,t,n,r,i,s){e.beginPath();e.moveTo(t,n+s);e.lineTo(t,n+i-s);e.quadraticCurveTo(t,n+i,t+s,n+i);e.lineTo(t+r-s,n+i);e.quadraticCurveTo(t+r,n+i,t+r,n+i-s);e.lineTo(t+r,n+s);e.quadraticCurveTo(t+r,n,t+r-s,n);e.lineTo(t+s,n);e.quadraticCurveTo(t,n,t,n+s);e.fill()}var t=isCanvasSupported(),n=false,e=e;if(t){var r=e.getContext("2d");var i=null,s=Math.sin(Math.PI/6),o=Math.cos(Math.PI/6);var u=0,a=0}else{}this.start=function(){if(n)return;n=true;if(t){$(e).show();i=setInterval(f,66)}else{var r=$('<img src="/images/loading.gif" width="100%" height="100%" />');$(e).html(r)}};this.stop=function(){if(t){if(i!=null){clearInterval(i);i=null}}else{$(e).html("")}$(e).hide();n=false};}function isCanvasSupported(){var e=document.createElement("canvas");return!!(e.getContext&&e.getContext("2d"))}_notifyBarWidget=null;_notifyBarJson=null;_liveNotifyBarWidget=null;_themeModule=null;_templateBarOptions={Plain:{barStyle:["style7","style1","style2","style3","style4"],barSymbol:["arrow_001","arrow_002","arrow_003","arrow_004"]},Stitch:{barStyle:["style1","style7","style2","style3","style4"],barSymbol:["arrow_001","arrow_002","arrow_003","arrow_004"]},Sharp:{barStyle:["style5","style4","style6"],barSymbol:["arrow_001","arrow_002","arrow_003","arrow_004"]}};var userPremium=false;configuratorFormTheme=function(){var e=this;var t=$(document).find("#customize_form");e.config={imageUrl:s3AmazonUrl+"/templates/backgrounds/",notifyForm:"#notificationedit"};init=function(n){e.setPresets(t.find(".template-themes .theme"),n);e.setPresets(t.find(".template-theme-colors .square"),n);e.setPattern(t.find(".textures .texture"),n);e.setPattern(t.find(".texture_colors .texture_group .texture_color"),n)};e.setConfiguratorData=function(n){var r={inputs:t,get:function(t){var n=e.getCookie(t);if(n!=null){return n}else{return e.getInputValue(t)}}};var i=0;$.each(r.inputs.find(":input"),function(){var i=$(this),s=i.attr("name");switch(i.get(0).tagName){case"INPUT":switch(i.attr("type")){case"hidden":if(!i.parent().hasClass("hidden")){if(s=="backgroundColor"||s=="messageColor"||s=="linkColor"){var o=function(e,t){r.inputs.find("#"+e).find('input[name="'+e+'"]').val(t);r.inputs.find("#"+e).find(".color").css({backgroundColor:"#"+t})};var u=function(e){return r.inputs.find("#"+e).find('input[name="'+e+'"]').val()};var a=function(t,r){if(t=="backgroundColor"){dataToSend={backgroundType:"solid",backgroundColor:r,backgroundTone:e.getColorType(r)};$.extend(n.configs.params,dataToSend);o(t,r);e.selectSavedColor()}if(t=="messageColor"){dataToSend={messageColor:r};$.extend(n.configs.params,dataToSend);o(t,r)}if(t=="linkColor"){dataToSend={linkColor:r};$.extend(n.configs.params,dataToSend);o(t,r)}_notifyBarJson=n;redrawWidget()};r.inputs.find("#"+s).ColorPickerSetColor(n.configs.params[s]);r.inputs.find("#"+s).ColorPicker({onShow:function(t){var n=u(s);e.setCookieVal({param:"tempColor",val:n});$(t).fadeIn(500);return false},onHide:function(t){var n=e.getCookie("tempColor");$(t).fadeOut(500);if(n!=""&&n!=null){var i=n.replace("#","");a(s,i);r.inputs.find("#"+s).ColorPickerSetColor(i)}return false},onChange:function(e,t,n){var r=t.replace("#","");a(s,r)},onSubmit:function(){e.setCookieVal({param:"tempColor",val:null});var t=u(s);a(s,t);if(s=="backgroundColor"){e.setCookieVal({param:"tempbackgroundColor",val:t});var i=r.inputs.find(".template-themes-inner .solid:eq(0)");i.addClass("active_theme").siblings().removeClass("active_theme")}e.postThemeData(dataToSend,true);delete dataToSend;e.addExtraTheme(false,n);$(".colorpicker").fadeOut()}})}}break;case"text":i.on("keyup keydown",function(e){var t=e.charCode||e.keyCode||0;if(t==46||t==8||t==9||t==27||t==13||t==65&&e.ctrlKey===true||t>=35&&t<=39){return}if(e.shiftKey||(t<48||t>57)&&(t<96||t>105)){e.preventDefault()}});if(s=="itemHeight"){i.inputValidator({validators:["digits"]});i.off().on("keyup",function(){var t=$(this).val();if(t>=35){setTimeout(function(){if(t<=35){r.inputs.find("#itemHeight").val(35);t=35}else if(t>80){r.inputs.find("#itemHeight").val(80);t=80}if(!i.hasClass("sending")){dataToSend={itemHeight:t};$.extend(n.configs.params,dataToSend);if(!e.isCustom()){oldFontSize=n.configs.params.itemFontSize;var s=e.getFontSize({itemHeight:n.configs.params.itemHeight,defaultItemFontSize:n.configs.params.default.itemFontSize});if(!s){s=oldFontSize}$("select[name=itemFontSize]").selectBox("value",s);$.extend(n.configs.params,dataToSend)}else{}_notifyBarJson=n;redrawWidget();e.postThemeData(dataToSend,false,i,function(e){})}},1e3)}})}if(s=="itemMessageDelay"){i.inputValidator({validators:["digits"]})}i.on("keydown focusout",function(t){var r=t.keyCode?t.keyCode:t.which?t.which:t.charCode;if(t.type=="keydown"&&r==13||t.type=="focusout"){if(!i.hasClass("sending")){var o=i.val();if(s=="itemHeight"){if(o==""){if(o==""||o==" "){o=n.configs.params.itemHeight==""?35:n.configs.params.itemHeight;i.val(o)}}if(o<=35&&o!="null"&&o!=""){i.val(35);o=35}else if(o>80){i.val(80);o=80}dataToSend={itemHeight:o};$.extend(n.configs.params,dataToSend);if(!e.isCustom()){oldFontSize=n.configs.params.itemFontSize;var u=e.getFontSize({itemHeight:n.configs.params.itemHeight,defaultItemFontSize:n.configs.params.default.itemFontSize});if(!u){u=oldFontSize}$("select[name=itemFontSize]").selectBox("value",u);$.extend(n.configs.params,dataToSend)}else{}_notifyBarJson=n;redrawWidget();e.postThemeData(dataToSend,false,i)}if(s=="itemMessageDelay"){if(t.type=="focusout"){if(o==""||o==" "){if(n.itemMessageDelay=="undefined"||n.itemMessageDelay==undefined){o=5;i.val(5)}else{o=n.itemMessageDelay==""?5:n.itemMessageDelay;i.val(o)}}else if(o==0){o=1;i.val(o)}}dataToSend={itemMessageDelay:o};$.extend(n.configs.params,dataToSend);_notifyBarJson=n;redrawWidget();e.postThemeData(dataToSend)}}}});break;case"checkbox":i.unbind().bind("click",function(){var t=!i.is(":checked")?"false":"true";dataToSend={};dataToSend[s]=t;$.extend(n.configs.params,dataToSend);_notifyBarJson=n;redrawWidget();if(s=="itemBorder"||s=="itemShadow"||s=="textShadow"||s=="itemRounded"||s=="backgroundGradient"){e.postThemeData(dataToSend,true);e.addExtraTheme(false,n)}else{e.postThemeData(dataToSend)}delete dataToSend});break;case"radio":var f=r.inputs.find('[type="radio"][name="'+s+'"]');var l=f.add(f.parent()).add(f.parent().find(".radioButtonLabel"));l.off().on("mousedown click",function(i){i.preventDefault();i.stopPropagation();$(".colorpicker").fadeOut();if($(this).hasClass("radioButtonLabel")){var o=$(this).parent().find('[type="radio"]')}else if($(this).hasClass("radiobuttoncustomize")){o=$(this).find('[type="radio"]')}else{o=$(this)}if(!o.hasClass("checked_radio")){$(".checked_radio").not(o).removeClass("checked_radio");o.addClass("checked_radio");var u=o.val();var a=o.attr("data-show");var f=o.attr("data-hide");var l=o.parent().parent();l.find('[type="radio"]').not(o).removeAttr("checked");o.prop("checked",true);var h=function(){if(o.hasClass("checked_radio")){o.prop("checked",true)}if(!o.is(":checked")){o.prop("checked",true)}};if(s=="barSymbol"){dataToSend={barSymbol:u};$.extend(n.configs.params,dataToSend);e.postThemeData(dataToSend,true);h()}if(s=="itemRounded"){dataToSend={itemRounded:u};$.extend(n.configs.params,dataToSend);e.postThemeData(dataToSend,true)}if(s=="barStyle"){dataToSend={barStyle:u};$.extend(n.configs.params,dataToSend);e.postThemeData(dataToSend,true);h()}if(s=="backgroundType"){var p=r.inputs.find(".template-themes");var d=r.inputs.find(".template-theme-colors");var v=p.find("."+u+":eq(0)");var m=v.attr("data-content");var g=d.find(".colors_group[id="+v.attr("id")+"]");dataToSend={backgroundType:u};if(u=="texture"){var y=e.getCookie("tempbackgroundTexture");if(y!=null){var b=d.find('.colors_group .color_type[data-content="'+y+'"]')}else{b=g.find('.color_type[data-content="'+m+'"]')}}else{b=g.find('.color_type[data-content="'+m+'"]')}if(b.find("input[type=hidden][name=backgroundType]").val()=="solid"){var w=e.getCookie("tempbackgroundColor");if(w!=null){var E=w}else{E=b.find('input[type="hidden"][name="backgroundColor"]').val()}$.extend(dataToSend,{backgroundColor:E,backgroundTone:e.getColorType(E)})}else{$.extend(dataToSend,{backgroundColor:b.find('input[type="hidden"][name="backgroundColor"]').val(),backgroundTone:b.find('input[type="hidden"][name="backgroundTone"]').val()})}$.extend(n.configs.params,dataToSend);if(dataToSend["backgroundType"]=="texture"){var S=dataToSend["backgroundColor"];var x=S.split("/");var T=t.find(".textures-inner");T.find('.texture[data-folder="'+x[0]+'"]').addClass("active").siblings().removeClass("active");$("#textures .texture_colors .texture_group").find('.texture_color[data-content="'+S+'"]').parent().removeClass("hide").show().siblings().addClass("hide").hide();$("#textures .texture_colors .texture_group").find('.texture_color[data-content="'+S+'"]').addClass("active").siblings().removeClass("active")}e.selectSavedColor();e.restoreColorPickerColor();e.postThemeData(dataToSend,true);h()}if(a!=="undefined"&&a!==false){r.inputs.find(a).each(function(){if($(this).hasClass("colorSelector")){$(this).parent().parent().show()}else{$(this).parent().show()}});h()}if(f!=="undefined"&&f!==false){r.inputs.find(f).each(function(){if($(this).hasClass("colorSelector")){$(this).parent().parent().hide()}else{$(this).parent().hide()}});h()}_notifyBarJson=n;redrawWidget();e.addExtraTheme(false,n);h()}});break}break;case"SELECT":i.unbind().bind("change",function(t){t.preventDefault();t.stopPropagation();dataToSend={};dataToSend[s]=i.val();$.extend(n.configs.params,dataToSend);if(s=="itemOpenClosePosition"){e.postThemeData(dataToSend)}if(s=="itemFontSize"){e.postThemeData(dataToSend,true);e.addExtraTheme(false,n)}if(s=="itemFontStyle"){e.postThemeData(dataToSend,true);e.addExtraTheme(false,n)}if(s=="itemFontFamily"){e.postThemeData(dataToSend,true);e.addExtraTheme(false,n)}if(s=="subHideDelay"){e.postThemeData(dataToSend)}if(s=="itemShowDelay"){e.postThemeData(dataToSend)}if(s=="itemFontSize"){$.extend(n.configs.params,{"default":{itemFontSize:""}})}_notifyBarJson=n;redrawWidget()});break}});r.inputs.find(".backgroundType").live("click mousedown",function(){$(".colorpicker").fadeOut()});r.inputs.find(".switcher").live("click",function(){var t=$(this);var n=r.inputs.find("#backgroundType");var i=r.inputs.find("#templateTheme .solid:eq(0)");var s=r.inputs.find('#template-theme-colors .colors_group[id="'+i.attr("id")+'"]');if(n.length&&n.filter('[value="solid"]').is(":checked")){i.addClass("active_theme").siblings().removeClass("active_theme");s.addClass("selected-colors").show().siblings().removeClass("selected-colors").hide()}else{var o=r.inputs.find(".textures-inner .active");var u=r.inputs.find('#templateTheme .theme[data-folder="'+o.attr("data-folder")+'"]');var a=r.inputs.find('.template-theme-colors .colors_group[id="'+u.attr("id")+'"]');a.addClass("selected-colors").show().siblings().removeClass("selected-colors").hide()}if(t.hasClass("advanced")&&r.inputs.find(".extraTheme").length){r.inputs.find("#template-theme-colors").parent().hide()}e.postThemeData({configView:t.hasClass("basic")?"advanced":"basic"})});init(n);e.selectDefaultTheme(n);var s=_themeModule.getCookie("customValues");if($(".extraTheme").length===0&&s){var o={configs:{params:JSON.parse(s)}};if(!_notifyBarJson.configs.params.customValues)_notifyBarJson.configs.params.customValues={};$.extend(_notifyBarJson.configs.params.customValues,o.configs.params);_themeModule.addExtraTheme(false,o,true)}};e.isCustom=function(){var e=t.find(".switcher").filter(".advanced");var n=t.find("#templateTheme").find(".extraTheme");if(n.length==0){return false}else{if(n.hasClass("active_theme")){return true}return false}if(e.length){if(e.is(":visible")){return true}}return false};e.getColorType=function(e){var t=e.replace("#","");var n=parseInt(t.substr(0,2),16);var r=parseInt(t.substr(2,2),16);var i=parseInt(t.substr(4,2),16);var s=(n*299+r*587+i*114)/1e3;return s>=128?"light":"dark"};e.setPattern=function(n,r){var i=t.find(".texture_colors");var s=i.find(".texture_group");var o=t.find(".textures .texture");var u=t.find(".template-theme-colors");var a=u.find(".colors_group");var f=t.find(".template-themes");var l=f.find(".theme");var c=function(e){var t=e.attr("id");var n=i.find("."+t);s.hide();n.show();n.find(".texture_color").removeClass("active");n.find(".texture_color:eq(0)").addClass("active");o.removeClass("active");e.addClass("active");var r=e.attr("data-content");var u=l.filter(".extraTheme");u.addClass("active_theme").siblings().removeClass("active_theme");p(r)};var h=function(e){e.siblings().removeClass("active");e.addClass("active");var t=e.attr("data-folder");var n=e.attr("data-content");var r=l.filter(".extraTheme");r.addClass("active_theme").siblings().removeClass("active_theme");p(n)};var p=function(t){var n=a.find('.color_type[data-content="'+t+'"]');var r=e.getCookie("tempbackgroundColor");n.parent().addClass("selected-colors").show();n.parent().siblings().removeClass("selected-colors").hide();n.siblings().removeClass("active_square");n.addClass("active_square");if(r!=null&&r==t){n.parent().find('.extra[data-content="'+r+'"]').remove()}};n.on("click",function(n){n.preventDefault();n.stopPropagation();var i=$(this);var s=i.attr("data-content");var o=t.find(".template-theme-colors .colors_group");var u=o.find('.color_type[data-content="'+s+'"]');dataToSend={backgroundColor:s,backgroundType:"texture",theme:"custom"};var a=u.find('input[name="textShadow"]');if(a.length){$.extend(dataToSend,{textShadow:a.val()})}var f=u.find('input[name="backgroundTone"]');if(f.length){$.extend(dataToSend,{backgroundTone:f.val()})}$.extend(r.configs.params,dataToSend);e.setCookieVal({param:"tempbackgroundTexture",val:r.configs.params.backgroundColor});var l=t.find("#messageColor");if(l.length){l.find('input[name="messageColor"]').val(r.configs.params.messageColor);l.find(".color").css("background-color","#"+r.configs.params.messageColor);l.ColorPickerSetColor(r.configs.params.messageColor)}var p=t.find("#linkColor");if(p.length){p.find('input[name="linkColor"]').val(r.configs.params.linkColor);p.find(".color").css("background-color","#"+r.configs.params.linkColor);p.ColorPickerSetColor(r.configs.params.linkColor)}_notifyBarJson=r;redrawWidget();e.addExtraTheme(i,r);if(i.hasClass("texture")){c(i)}else if(i.hasClass("texture_color")){h(i)}e.postThemeData(dataToSend,true);return false})};e.getInputValue=function(e){var n=t.find(".template-theme-colors .colors_group:eq(0) .color_type:eq(0)");var r=t.find("#"+e);if(r.length==0){return n.find('[name="'+e+'"]').val()}else{if(r.get(0).tagName=="INPUT"){switch(r.attr("type")){case"hidden":case"text":if(!r.parent().hasClass("hidden")){return r.val()}break;case"radio":return r.filter(":checked").val();break;case"checkbox":return!r.is(":checked")?"false":"true";break}}else if(r.get(0).tagName=="SELECT"){return r.val()}else if(r.get(0).tagName=="DIV"){if(r.hasClass("colorSelector")){return n.find('[name="'+e+'"]').val()}}}return false};e.setPresets=function(n,r){var i=t.find("#textures").find(".textures .texture");var s=t.find(".texture_colors").find(".texture_group");var o=t.find(".template-themes .theme");var u=t.find(".template-theme-colors");var a=u.find(".colors_group");var f=function(e){e.addClass("active_theme").siblings().removeClass("active_theme");a.removeClass("selected-colors").hide();a.find(".color_type").removeClass("active_square");var t=u.find(".colors_group").filter("[id="+e.attr("id")+"]").addClass("selected-colors").removeClass("hide").show();t.siblings().addClass("hide");t.find('.color_type[data-content="'+e.data("content")+'"]').addClass("active_square");if(!e.hasClass("extraTheme")){t.parent().add(t.parent().parent()).add(t.parent().parent().parent()).show()}i.filter('[data-folder="'+e.attr("data-folder")+'"]').addClass("active").siblings().removeClass("active");var n=s.find('.texture_color[data-content="'+e.data("content")+'"]').addClass("active");n.siblings().removeClass("active");n.parent().show().siblings().hide()};var l=function(e){var t=e.parent().data("content");var n=e.parent().attr("data-folder");var r=e.parent();i.filter('[data-folder="'+n+'"]').addClass("active").siblings().removeClass("active");var o=s.find('.texture_color[data-content="'+t+'"]').addClass("active");o.siblings().removeClass("active");r.siblings().removeClass("active_square");r.addClass("active_square")};var c=function(e){var t=e.attr("id");var n=e.data("content");if(e.hasClass("square")){l(e);var r=$(".active_theme").find("input[type=hidden]");var i=e.parent().find("input[type=hidden]");$.extend(r,i);return r}else if(e.hasClass("theme")&&!e.hasClass("extraTheme")){var s=u.find('.colors_group[id="'+t+'"]');var o=s.find(".color_type").filter('[data-content="'+n+'"]');f(e);return o.find("input[type=hidden]")}else{l(e.find('.innertheme:not(".innerText")'));return e.find("input[type=hidden]")}return false};n.off().on("click",function(n){var i=$(this);if(t.find(".switcher:visible").hasClass("basic")){u.parent().show()}var s=c(i);if(i.hasClass("extraTheme")){o=null;u.parent().hide();i.parent().find(".theme").removeClass("active_theme");i.addClass("active_theme")}else{var o=null;u.parent().show();i.parent().find(".extraTheme").removeClass("active_theme")}if(i.hasClass("theme")){var a=i.hasClass("texture")?"texture":"solid";i.addClass("active_theme").siblings().removeClass("active_theme")}else if(i.hasClass("square")){a=i.parent().hasClass("texture")?"texture":"solid"}var f=s.filter('[name="backgroundType"]');if(f.length==0){var l=a}else{l=f.val()}dataToSend={backgroundType:l};s.each(function(){var n=this.name;var r=n=="itemFontSize"&&o!=null?o:this.value;if(n=="itemFontSize"){}if(n!="itemButton"){dataToSend[n]=r}var i=t.find("#"+n);if(i.length>0){if(i.get(0).tagName=="INPUT"){switch(i.attr("type")){case"text":i.val(r);break;case"checkbox":if(n!="itemButton"){if(r=="true"){i.attr("checked","checked")}else{i.removeAttr("checked")}}break;case"radio":i.removeAttr("checked").removeClass("checked_radio");i.filter('[value="'+r+'"]').attr("checked","checked").addClass("checked_radio");break}}else if(i.get(0).tagName=="SELECT"){if(t.find("#"+n+"").length){$('select[name="'+n+'"]').selectBox("value",r)}}else if(i.get(0).tagName=="DIV"){if(i.hasClass("colorSelector")){if(n=="backgroundColor"){if(l=="solid"){e.setCookieVal({param:"tempbackgroundColor",val:r})}else{e.setCookieVal({param:"tempbackgroundTexture",val:r})}}i.find('input[name="'+n+'"]').val(r);i.find(".color").css({backgroundColor:"#"+r});i.ColorPickerSetColor(r)}}}});if((i.hasClass("theme")||i.hasClass("square"))&&!i.hasClass("extraTheme")){if(i.hasClass("square")){dataToSend["theme"]=i.parent().parent().attr("id")}else{dataToSend["theme"]=i.attr("id")}}else{dataToSend["theme"]="custom"}$.extend(_notifyBarJson.configs.params,dataToSend);if($.inArray(_notifyBarJson.configs.params.barStyle,_templateBarOptions[_notifyBarJson.configs.template_name].barStyle)<0){_notifyBarJson.configs.params.barStyle=_templateBarOptions[_notifyBarJson.configs.template_name].barStyle[0]}if($.inArray(_notifyBarJson.configs.params.barSymbol,_templateBarOptions[_notifyBarJson.configs.template_name].barSymbol)<0){_notifyBarJson.configs.params.barSymbol=_templateBarOptions[_notifyBarJson.configs.template_name].barSymbol[0]}$("#backgroundType").removeAttr("checked");if(l=="solid"){$("#textures").parent().hide();$('#backgroundType[value="solid"]').attr("checked",true)}else{$('#backgroundType[value="texture"]').attr("checked",true)}e.postThemeData(dataToSend,false,i);$.extend(_notifyBarJson.configs.params,{"default":{itemFontSize:r.configs.params.itemFontSize,linkColor:r.configs.params.itemFontSize}});redrawWidget();return false})};e.save=function(t,n){if(n==undefined||n=="undefined"||n==null){n=null}e.setCookieVal(t);e.postData(t,n);return false};e.setCookie=function(e,t,n){if(arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(t))||t===null||t===undefined)){n=$.extend({},n);if(t===null||t===undefined){n.expires=-1}if(typeof n.expires==="number"){var r=n.expires,i=n.expires=new Date;i.setDate(i.getDate()+r)}t=String(t);return document.cookie=[encodeURIComponent(e),"=",n.raw?t:encodeURIComponent(t),n.expires?"; expires="+n.expires.toUTCString():"",n.path?"; path="+n.path:"",n.domain?"; domain="+n.domain:"",n.secure?"; secure":""].join("")}n=t||{};var s=n.raw?function(e){return e}:decodeURIComponent;var o=document.cookie.split("; ");for(var u=0,a;a=o[u]&&o[u].split("=");u++){if(s(a[0])===e)return s(a[1]||"")}return null};e.getCookie=function(t){return e.setCookie("notificationBar_"+t)};e.setCookieVal=function(t){e.setCookie("notificationBar_"+t.param,null);e.setCookie("notificationBar_"+t.param,t.val,{expires:1});return false};e.postData=function(e,t){if(t==undefined||t=="undefined"||t==null){$.ajax({type:"POST",cache:false,data:{hash:notify.hash,page:"save-notificationbar",param:e.param,data:e.val},error:function(){},success:function(e){}})}else{$.ajax({type:"POST",cache:false,data:{hash:notify.hash,page:"save-notificationbar",param:e.param,data:e.val,custom:t},error:function(){},success:function(e){}})}return false};e.postThemeData=function(e,t,n,r){if(t==undefined||t=="undefined"){t=false}if(n==undefined||n=="undefined"){n=null}var i={hash:notify.hash,page:"save-notificationbar",theme:e};if(t!=false){$.extend(i,{custom:"true"})}if(e.configView=="advanced"){_gaq.push(["_trackEvent","Configurator Advanced Customization","Click"])}$.ajax({type:"POST",cache:false,data:i,beforeSend:function(){if(n!=null){n.addClass("sending")}},error:function(){},success:function(e){if(r&&typeof r==="function"){r(e.data)}if(n!=null){n.removeClass("sending")}}});return false};e.retrieveTempVal=function(t,n){var r=notifyBar;if(t!="undefined"){return t}else{var i=e.getCookie(n);if(i!=null){return i}}return false};e.currentURL=function(){return location.protocol+"//"+location.hostname+(location.port?":"+location.port:"")+location.pathname+(location.search?location.search:"")};e.retrieveConfigData=function(){var n=t.find(".radiobuttoncustomize");var r=t.find(".input_checkbox");var i=t.find(".input_combobox");var s=t.find(".colorSelector");var o=n.find("#barSymbol:checked");var u=n.find("#backgroundType:checked");var a=u.length?u.val():"solid";var f={backgroundType:n.find("#backgroundType:checked").val(),backgroundGradient:!r.find('[name="backgroundGradient"]').is(":checked")?"false":"true",itemRounded:!r.find('[name="itemRounded"]').is(":checked")?"false":"true",barStyle:n.find("#barStyle:checked").val(),barSymbol:n.find("#barSymbol:checked").val(),messageColor:s.find('[name="messageColor"]').val(),linkColor:s.find('[name="linkColor"]').val(),itemFontFamily:i.find('[name="itemFontFamily"]').find("option:selected").val(),itemFontSize:i.find('[name="itemFontSize"]').find("option:selected").val(),itemFontStyle:i.find('[name="itemFontStyle"]').find("option:selected").val(),textShadow:!r.find('[name="textShadow"]').is(":checked")?"false":"true",itemShadow:!r.find('[name="itemShadow"]').is(":checked")?"false":"true"};if(o.length==0){$.extend(f,{barSymbol:o.filter(":eq(0)").val()})}else{$.extend(f,{barSymbol:o.val()})}if(r.find('[name="itemBorder"]').length){$.extend(f,{itemBorder:!r.find('[name="itemBorder"]').is(":checked")?"false":"true"})}if(a=="texture"){var l=t.find("#template-theme-colors");var c=t.find(".textures-inner .texture");var h=t.find(".texture_colors .texture_group");var p=c.filter(".active:eq(0)").attr("data-folder");var d=h.find('.texture_color[data-folder="'+p+'"]').filter(".active:eq(0)");var v=l.find('.colors_group .color_type[data-content="'+d.attr("data-content")+'"]');$.extend(f,{backgroundColor:v.find('[name="backgroundColor"]').val(),backgroundTone:v.find('[name="backgroundTone"]').val()})}else{var m=s.find('[name="backgroundColor"]').val();$.extend(f,{backgroundColor:m,backgroundTone:e.getColorType(m)})}return f};e.addExtraTheme=function(n,r,i){var s=r.configs.params;if(s==undefined||s=="undefined"||s==null){s=e.retrieveConfigData()}var o=t.find(".textures-inner .texture");var u=t.find(".texture_colors .texture_group");var a=t.find("#template-theme-colors");var f=t.find("#templateTheme");var l=t.find("#templateTheme").find('.theme:not(".extraTheme"):eq(0)');var c=t.find("#templateTheme").find(".extraTheme");var h=$("<span>").addClass("innertheme").css({background:"url("+e.config.imageUrl+"thumbnails/theme_custom.png) no-repeat center center",position:"absolute",top:0,left:0,zIndex:0});if(!c.length){var p=l.clone();p.addClass("extraTheme").insertBefore(l);c=t.find("#templateTheme").find(".extraTheme")}c.removeClass("active_square").addClass("active_theme");var d=1;f.find("br").remove();f.find(".theme").each(function(){if(d%5==0){$("<br/>").prop("clear","all").insertAfter($(this))}d++});if(!n){if(s.backgroundType=="solid"){c.removeClass("texture").addClass("solid");c.removeAttr("data-folder");c.attr({id:"custom","data-content":s.backgroundColor,"data-target":"backgroundType"}).css({position:"relative"}).addClass("active_theme").empty().prepend(h)}else{var v=o.filter(".active:eq(0)").attr("data-folder");n=u.find('.texture_color[data-folder="'+v+'"]').filter(".active:eq(0)");c.removeAttr("data-target").attr({id:"custom","data-content":s.backgroundColor,"data-folder":v}).css({position:"relative"}).addClass("active_theme").removeClass("solid").addClass("texture").empty().prepend(h)}}else{c.attr({id:"custom","data-folder":n.attr("data-folder"),"data-content":n.attr("data-content")}).css({position:"relative"}).removeClass("solid").addClass("texture").addClass("active_theme").empty().prepend(h);$.extend(s,{backgroundColor:n.attr("data-content")})}var m=["itemHeight","itemShowDelay","subHideDelay","itemPushing","itemOntop","itemUsebounce","itemDismiss","itemBtnCollapse","itemBottom","itemButton","itemTarget","itemMessageDelay","itemClosable","itemOpenClosePosition","controlTabs"];$.each(s,function(e,t){if($.inArray(e,m)<0){var n=c.find('input[type="hidden"][name="'+e+'"]');if(!n.length){$("<input/>").attr({type:"hidden",name:e,value:t}).appendTo(c)}else{n.val(t)}}});if(!i){c.parent().find('.theme:not(".extraTheme")').removeClass("active_theme");c.removeClass("active_square").addClass("active_theme");a.parent().hide()}else{c.removeClass("active_square active_theme")}var g={configs:{params:{}}};if(r.configs.params.backgroundType)g.configs.params.backgroundType=r.configs.params.backgroundType;if(r.configs.params.backgroundColor)g.configs.params.backgroundColor=r.configs.params.backgroundColor;if(r.configs.params.backgroundGradient)g.configs.params.backgroundGradient=r.configs.params.backgroundGradient;if(r.configs.params.backgroundTone)g.configs.params.backgroundTone=r.configs.params.backgroundTone;if(r.configs.params.messageColor)g.configs.params.messageColor=r.configs.params.messageColor;if(r.configs.params.linkColor)g.configs.params.linkColor=r.configs.params.linkColor;if(r.configs.params.itemFontFamily)g.configs.params.itemFontFamily=r.configs.params.itemFontFamily;if(r.configs.params.itemFontSize)g.configs.params.itemFontSize=r.configs.params.itemFontSize;if(r.configs.params.itemFontStyle)g.configs.params.itemFontStyle=r.configs.params.itemFontStyle;if(r.configs.params.textShadow)g.configs.params.textShadow=r.configs.params.textShadow;if(r.configs.params.itemRounded)g.configs.params.itemRounded=r.configs.params.itemRounded;if(r.configs.params.barStyle)g.configs.params.barStyle=r.configs.params.barStyle;if(r.configs.params.barSymbol)g.configs.params.barSymbol=r.configs.params.barSymbol;if(r.configs.params.itemBorder)g.configs.params.itemBorder=r.configs.params.itemBorder;if(r.configs.params.itemShadow)g.configs.params.itemShadow=r.configs.params.itemShadow;$.userApi.cookie("notificationBar_customValues",JSON.stringify(g.configs.params));e.setPresets(c,r)};e.selectSavedColor=function(){var n=t.find(".template-theme-colors .colors_group .extra");if(n.length!=0){n.parent().parent().find(".colors_group").removeClass("selected-colors").hide();n.parent().addClass("selected-colors").show();n.parent().find(".solid").removeClass("active_square");n.addClass("active_square");$(document).find(".template-themes-inner .solid:eq(0)").addClass("active_theme").siblings().removeClass("active_theme");e.setPresets(n)}return false};e.restoreColorPickerColor=function(){var n=e.getCookie("tempbackgroundColor");if(n==null){n="c63619"}t.find("#backgroundColor div").css({backgroundColor:"#"+n});t.find("#backgroundColor input").val(n);t.find("#backgroundColor").ColorPickerSetColor(n)};e.selectDefaultTheme=function(n){var r=t.find(".template-themes");var i=t.find("#template-theme-colors");var s=r.find(".active_theme");if(!e.isCustom()){var o=n.configs.params.itemFontSize;var u=e.getFontSize({itemHeight:n.configs.params.itemHeight,defaultItemFontSize:n.configs.params.default.itemFontSize});if(!u){u=o}$("select[name=itemFontSize]").selectBox("value",u)}if(s.length==0){var a="";if(n.configs.params.backgroundColor==undefined||n.configs.params.backgroundColor=="undefined"){a=n.configs.template_theme}else{a=n.configs.params.backgroundColor}if(n.configs.params.theme==undefined||n.configs.params.theme=="undefined"){var f="1"}else{var f=n.configs.params.theme}var l=r.find("#"+f).addClass("active_theme");var c=i.find('.colors_group[id="'+l.attr("id")+'"]').addClass("selected-colors").show();c.find('.color_type[data-content="'+a+'"]').addClass("active_square");c.siblings().removeClass("selected-colors").hide();c.parent().add(c.parent().parent()).show()}};e.getFontSize=function(e){var t=[10,11,12,14,16,18,20,22,26,28,32,36],n=40,r=e.itemHeight;var i,s=0,o=parseInt(e.defaultItemFontSize),u=false;i=Math.max(Math.floor((r-n)/10),0);while(!u){if(t[s]===o){u=true}else{if(s==t.length-1)break;else s++}}if(!u)return false;else{if(s+i>=t.length-1)return t[t.length-1];else if(s+i<=0)return t[0];else return t[s+i]}}};var rulesCreationInProgress=false;var rulesUpdater=function(){$.ajax({type:"POST",data:{page:"save-notificationbar",hash:notify.hash,cache:false,displayRulesFlag:true,displayRules:getDisplayRulesData(),reloadConfig:"true"},beforeSend:function(){myPreviewPreloader($("#preview .wrapper"))},complete:function(e){$("#preview .wrapper").find(".loading").remove();$("#preview .wrapper").empty().removeAttr("style");if($("#preview .wrapper").find(".loading").length){$("#preview .wrapper").find(".loading").remove()}else{initWidget()}}});_notifyBarJson.configs.displayRulesFlag="true"};var rulesDeleteAll=function(){$.ajax({type:"POST",data:{page:"save-notificationbar",hash:notify.hash,cache:false,displayRulesFlag:false,reloadConfig:"true"},beforeSend:function(){$("#displayRulesFlag").addClass("inProgress");$("#displayRulesFlag").attr("disabled",true);myPreviewPreloader($("#preview .wrapper"))},complete:function(e){$("#preview .wrapper").find(".loading").remove();$("#preview .wrapper").empty().removeAttr("style");if($("#preview .wrapper").find(".loading").length){$("#preview .wrapper").find(".loading").remove()}else{initWidget()}$("#displayRulesFlag").removeAttr("disabled");$("#displayRulesFlag").removeClass("inProgress")}})};var ruleRemover=function(){$.ajax({type:"POST",data:{page:"save-notificationbar",hash:notify.hash,cache:false,deleteRule:true,displayRules:getDisplayRulesData(),reloadConfig:"true"},beforeSend:function(){myPreviewPreloader($("#preview .wrapper"))},complete:function(e){$("#preview .wrapper").find(".loading").remove();$("#preview .wrapper").empty().removeAttr("style");if($("#preview .wrapper").find(".loading").length){$("#preview .wrapper").find(".loading").remove()}else{initWidget()}}})};$("select.itemDisplayRuleCondition").live("change",function(e){e.preventDefault();e.stopPropagation();clearTimeout($(this).data("timeout"));var t=this;$(this).data("timeout",setTimeout(function(){rulesUpdater()},500))});$("input.itemDisplayRuleTarget").live("keyup",function(e){e.preventDefault();e.stopPropagation();clearTimeout($(this).data("timeout"));var t=this;$(this).data("timeout",setTimeout(function(){var e=getDisplayRulesData();rulesUpdater()},500))});$("select.itemDisplayRuleType").live("change",function(e){e.preventDefault();e.stopPropagation();clearTimeout($(this).data("timeout"));var t=this;$(this).data("timeout",setTimeout(function(){rulesUpdater()},500))});$(document).ready(function(){function r(e){var t=e.width(),n=e.height();e.find(".loading").remove();e.css({position:"relative",textAlign:"center"}).width(t).height(n).empty().append($("<img />").addClass("loading").css({position:"absolute",left:(t-16)/2,top:(n-32)/2}).attr({src:"/images/loading.gif",width:32,height:32}))}function i(e){if(e=="Link URL"){e=""}if(!(e.match(/http:\/\//)||e.match(/https:\/\//)||e.match(/ftp:\/\//)||e.match(/ftps:\/\//)||e.match(/mailto:/))){e=""+e}return e}function s(){var e=$("#notificationedit");var t=e.find('.type_checkboxes [name="message_type"]:checked');var n=e.find('.chosetemplate .active [name="templateId"]');var r={templateId:n.val(),message_type:t.val()};switch(t.val()){case"Manual":var i={};e.find(".messagefield").not(".disabled").each(function(e,t){var n=e+1;i["m"+n]={content:$(this).find("#message").val(),link:$(this).find("#link_url").val(),text:$(this).find("#link_text").val()}});$.extend(r,{message:i});break;case"Twitter":$.extend(r,{total_tweets:e.find('input[name="total_tweets"]').fetchVal(),twitter_username:e.find('input[name="twitter_username"]').fetchVal()});break;case"RSS Feed":$.extend(r,{feed_url:e.find('input[name="feed_url"]').fetchVal(),entries:e.find('input[name="entries"]').fetchVal(),rss_readmore_text:e.find('input[name="rss_readmore_text"]').fetchVal()});break}return r}function u(){$.ajax({type:"post",data:{page:"save-"+notify.type,hash:notify.hash,notifyData:s()},complete:function(){}})}function p(e){var t=$("#notificationedit .messagefield").not(".disabled");if($("#notificationedit .disabled").size()===0&&t.length<5){var n=t.clone();t.filter(":last").after(n);n.addClass("disabled").removeAttr("id");n.find("input:eq(0)").addClass("new_message");n.find("label:eq(0)").html("Add new message");n.find("#message").addClass("empty").removeAttr("style").val("Enter your message here");n.find("#link_text").addClass("empty").val("Button label");n.find("#link_url").addClass("empty").val("Link URL");n.find("a.delete,.message_links").remove();n.find("input:eq(0)").bind("focus",function(){var e=$(document).find("#notificationedit .messagefield").not(".disabled");if(e.length<5){setTimeout(d,1)}if(e.length==5){$("#notificationedit .disabled").fadeOut("fast")}return false})}$("#notificationedit .disabled:gt(0)").remove()}function d(){var e=$(document).find("#notificationedit .messagefield").not(".disabled");var t=$(document).find("#notificationedit .disabled");if(e.length<5){var n=e.length+1;var r=e.filter(":last").clone();e.filter(":last").after(r);r.attr({id:n}).find("label:eq(0) .count").text(n);r.find("#message").val("Enter your message here").attr({name:"message.m"+n+".content"}).removeClass("empty");r.find("#link_text").val("Button label").attr({name:"message.m"+n+".text"}).removeClass("empty");r.find("#link_url").val("Link URL").attr({name:"message.m"+n+".link"}).removeClass("empty");r.find(".delete-separator").show();r.find(".delete").show();var i={message:"Enter your message here",linktext:"Button label",linkhref:"Link URL"};_notifyBarWidget.showMessage(n-1,i);p(1);r.find("input:eq(0)").focus();g(r);if(n===5){t.hide()}u();return r}return false}function v(){var e=$("#notificationedit");var t=e.find(".messagefield").not(".disabled");t.each(function(e,t){var n=e+1;$(this).attr({id:n}).find("label:eq(0) .count").text(n);$(this).find("#message").attr({name:"message.m"+n+".content"});$(this).find("#link_text").attr({name:"message.m"+n+".text"});$(this).find("#link_url").attr({name:"message.m"+n+".link"})});m(1);if(t.length<5){var n=e.find(".disabled");if(n.length){e.find(".disabled").show()}else{p(2)}}else{e.find(".disabled").hide()}u();var r=s();_notifyBarWidget.resetMessages(r.message)}function m(e){var t=$("#notificationedit .messagefield").not(".disabled");t.removeClass("first last").find(".movable").find("a,i").show();if(t.length>1){t.filter(":eq(0)").find(".delete-separator").show();t.filter(":eq(0)").find(".delete").show();t.find(".movable").show()}else{t.filter(":eq(0)").find("#message").removeAttr("style");t.filter(":eq(0)").find(".delete-separator").hide();t.filter(":eq(0)").find(".delete").hide();t.find(".movable").hide()}t.filter(":last").removeClass("first").addClass("last").find(".movable").find(".move-down,i").not(".delete-separator").hide();t.filter(":first").removeClass("last").addClass("first").find(".movable").find(".move-up,i").not(".delete-separator").hide()}function g(e){e.applyPlaceholders();e.find(".delete").click(function(){if($("#notificationedit").find(".messagefield").not(".disabled").length>1){$(this).parent().parent().parent().slideUp("fast",function(){$(this).remove();v()})}return false});e.find(".move-up").click(function(){var e=$(this).parent().parent().parent();e.insertBefore(e.prev());v();return false});e.find(".move-down").click(function(){var e=$(this).parent().parent().parent();e.insertAfter(e.next());v();return false});var t="";e.find("#link_text").inputValidator({limit:30});e.find(":input").bind("keyup keydown focusout",function(e){var n=e.keyCode?e.keyCode:e.which?e.which:e.charCode;if(e.type=="keydown"&&n==13||e.type=="focusout"||e.type=="keyup"){var r=$(this);var i=r.val()!=""?r.val():t;if(i=="undefined"||i==undefined){i=""}if(r.attr("id")=="message"){var s=r.parent().parent()}else{var s=r.parent().parent().parent()}var o=s.find("#message").val();var u=s.find("#link_text").val();var a=s.find("#link_url").val();var f=parseInt(s.attr("id"))-1;var l={message:o,linktext:u,linkhref:a};switch(r.attr("id")){case"message":$.extend(l,{message:i});break;case"link_text":$.extend(l,{linktext:i});break;case"link_url":i=i;$.extend(l,{linkhref:i});break}if(_notifyBarWidget){_notifyBarWidget.showMessage(f,l)}}});e.find("input").not(".new_message").bind("focus",function(e){if($(this).attr("id")=="message"){var t=$(this).parent().parent()}else{var t=$(this).parent().parent().parent()}var n=parseInt(t.attr("id"))-1;_notifyBarWidget.showMessage(n);return false});m(2)}var e=function(e){var t=document.cookie.split(/;\s*/),n=[],r;for(r=0;r<t.length;r++){if(t[r].match(e)){n.push(t[r])}}return n};if($.userApi.cookie("notifySnack_Hash")==null||$.userApi.cookie("notifySnack_Hash")!=notify.hash){$.userApi.cookie("notifySnack_Hash",notify.hash);$.each(e(/^notificationBar_/),function(){var e=this.split("=");$.userApi.cookie(e[0],null)})}var t=false;var n={init:function(e){n.s={wrapper:".chosetemplate",item:".chosetemplate .template_div",config:"#allGeneratedContols #tcontent",preview:"#preview .wrapper"};$.extend(n.s,e);n.setup()},setup:function(){$(n.s.item).unbind().bind("click",function(){if(t)return;t=true;$(n.s.item).removeClass("active");$(this).addClass("active");n.saveTemplate({template:$(this).find('[name="templateId"]').val(),item:notify.hash});return false})},saveTemplate:function(e){$.ajax({data:{page:"choose-template",item:e.item,template:e.template},beforeSend:function(e){r($(n.s.preview));r($(n.s.config))},success:function(e){$(n.s.preview).removeAttr("style").find(".loading").remove();$(n.s.config).removeAttr("style").find(".loading").remove();initWidget();$(n.s.config).html(e.data).show();var r=$('.type_checkboxes input[type="radio"]:checked').attr("id");if(r=="twitter"){$(this).data("timeout",setTimeout(function(){disableCheckBox("disable")},100))}t=false}})},cleanCookies:function(){$.userApi.cookie("notifySnack_Hash",notify.hash);$.each(e(/^notificationBar_/),function(){var e=this.split("=");if(e[0]!="notificationBar_"+notify.hash+"_url"&&e[0]!="notificationBar_"+notify.hash+"_scroll"&&e[0]!="notificationBar_itemHeight"&&e[0]!="notificationBar_itemAutoShow"&&e[0]!="notificationBar_itemShowDelay"&&e[0]!="notificationBar_subAutoHide"&&e[0]!="notificationBar_subHideDelay"&&e[0]!="notificationBar_itemPushing"&&e[0]!="notificationBar_itemOntop"&&e[0]!="notificationBar_itemUsebounce"&&e[0]!="notificationBar_itemDismiss"&&e[0]!="notificationBar_itemBtnCollapse"&&e[0]!="notificationBar_itemBottom "&&e[0]!="notificationBar_displayRulesFlag"&&e[0]!="notificationBar_itemTarget"&&e[0]!="notificationBar_itemButton"&&e[0]!="notificationBar_itemMessageDelay"&&e[0]!="notificationBar_itemClosable"&&e[0]!="notificationBar_itemOpenClosePosition"){$.userApi.cookie(e[0],null)}})}};n.init();$("#notificationedit .type_checkboxes .message_type_checkbox").bind("mousedown click",function(e){e.preventDefault();e.stopPropagation();var t=$(this).find('input[type="radio"]');var n=t.parent().parent().find('input[type="radio"]');$("#notificationedit :input").blur();$("#message_type_twitter,#message_type_rss_feed").applyPlaceholders();if(!t.is(":checked")&&!t.hasClass("sending")){if(!n.hasClass("sending")){n.removeAttr("checked");t.attr("checked",true);$(".message_type_wrap").hide();$("#message_type_"+t.attr("id")).show();$("#preview .wrapper").find(".loading").remove();$("#preview .wrapper").empty().removeAttr("style");$.ajax({type:"post",data:{page:"save-"+notify.type,hash:notify.hash,notifyData:s(),reloadConfig:"true"},beforeSend:function(){t.addClass("sending");r($("#preview .wrapper"));r($("#allGeneratedContols #tcontent"))},complete:function(e){$("#preview .wrapper").find(".loading").remove();$("#preview .wrapper").empty().removeAttr("style");n.removeClass("sending");if($("#preview .wrapper").find(".loading").length){$("#preview .wrapper").find(".loading").remove()}else{initWidget()}},success:function(e){$("#allGeneratedContols #tcontent").removeAttr("style");if($("#allGeneratedContols #tcontent").find(".loading").length){$("#allGeneratedContols #tcontent").find(".loading").remove()}$("#allGeneratedContols #tcontent").html(e.data.config_html).show();if(t.attr("id")=="twitter"){$(this).data("timeout",setTimeout(function(){disableCheckBox("disable")},500))}}})}}return false});$('#notificationedit input[type="text"]').live("keyup",function(e){e.preventDefault();e.stopPropagation();clearTimeout($(this).data("timeout"));$(this).data("timeout",setTimeout(function(){u()},1e3))});$.fn.fetchVal=function(){if($(this).attr("data-default-text")==undefined||$(this).attr("data-default-text")=="undefined"){return $(this).val()}if($(this).val()!=$(this).attr("data-default-text")){return $(this).val()}return""};var o;$('#message_type_twitter input[type="text"],#message_type_rss_feed input[type="text"]').off().on("keydown keyup",function(e){clearTimeout(o);var t=e.keyCode?e.keyCode:e.which?e.which:e.charCode;var n=function(){$.ajax({type:"post",data:{page:"save-"+notify.type,hash:notify.hash,notifyData:s()},beforeSend:function(){r($("#preview .wrapper"))},complete:function(){$("#preview .wrapper").removeAttr("style").find(".loading").remove();initWidget()}})};var i=$(this);if(e.type=="keyup"){o=setTimeout(function(){n();i.blur();$("#message_type_twitter,#message_type_rss_feed").applyPlaceholders()},3e3)}if(e.type=="keydown"&&t==13){n();i.blur();$("#message_type_twitter,#message_type_rss_feed").applyPlaceholders()}});$.each($("#notificationedit button"),function(){var e=$(this).parent(),t=e.find('input[type="text"]'),n=e.find(".minus"),r=e.find(".plus");if(t.val()==1){n.removeClass("active").addClass("inactive");r.removeClass("inactive").addClass("active")}else if(t.val()==5){n.removeClass("inactive").addClass("active");r.removeClass("active").addClass("inactive")}});$("#notificationedit button").off().on("click",function(){var e=$(this).parent(),t=e.find('input[type="text"]'),n=e.find(".minus"),i=e.find(".plus");if(t.val()>1){n.addClass("active").removeClass("inactive")}else{n.removeClass("active").addClass("inactive")}if(t.val()<5){i.addClass("active").removeClass("inactive")}else{i.removeClass("active").addClass("inactive")}clearTimeout($(this).data("timeout"));$(this).data("timeout",setTimeout(function(){$.ajax({type:"post",data:{page:"save-"+notify.type,hash:notify.hash,notifyData:s()},beforeSend:function(){r($("#preview .wrapper"))},complete:function(){$("#preview .wrapper").removeAttr("style").find(".loading").remove();initWidget()}})},1e3))});$("#process_steps_next,#process_steps_nextt").unbind().bind("click",function(e){e.preventDefault();e.stopPropagation();c($(this));return false});var a=function(e){var t=0,n;for(n in e){if(e.hasOwnProperty(n))t++}return t};var f=function(e,t){for(var n=0;n<e.length;n++){if(e[n]===t){return true}}return false};var l=function(e,t){var n=e.configs.notify;var r=e.configs.params;var i=[];i=["_trackEvent","Configurator Messages","Publish Click","messageType-"+n.message_type];_gaq.push(i);if(n.message_type=="Twitter"){i=["_trackEvent","Configurator Messages","Publish Click","messagesNr-"+n.total_tweets]}else if(n.message_type=="RSS Feed"){i=["_trackEvent","Configurator Messages","Publish Click","messagesNr-"+n.entries]}else{var s=a(n.message);i=["_trackEvent","Configurator Messages","Publish Click","messagesNr-"+s]}_gaq.push(i);var o=["Custom","Solid","Stripes 1","Waves","Stripes 2","Textile","Noise","Dots","Leather","Tire","Grid","Braiding","Jeans","Squares"];var u=0;if(r.theme==undefined||r.theme=="undefined"){u=1}else{if(r.theme=="custom"){u=0}else{u=r.theme}}i=["_trackEvent","Configurator Themes","Publish Click","usedTheme-"+o[u]];_gaq.push(i);for(k in r){var l=["itemHeight","itemShowDelay","subHideDelay","itemPushing","itemOntop","itemUsebounce","itemDismiss","itemBtnCollapse","itemBottom","itemButton","itemTarget","itemMessageDelay","itemClosable","itemOpenClosePosition"];if(f(l,k)){i=["_trackEvent","Configurator Left Settings","Publish Click",k+"-"+r[k]];_gaq.push(i)}}var c=setTimeout(function(){if(t&&typeof t==="function"){t()}},3e3)};var c=function(e){var t=e.attr("id");var n=s();var r=true;$.ajax({data:{page:"get-item-name",hash:notify.hash},success:function(e){if(e.data==""){r="Notification name can't be empty"}else{switch(n.message_type){case"Twitter":var i=n.twitter_username;if(i==undefined||i==""){r="Please fill in a Twitter username"}break;case"RSS Feed":i=n.feed_url;if(i==undefined||i==""){r="Please fill in a feed URL"}break}}if(r!=true){showErrorMessage(r,2e4)}else{$.ajax({type:"post",data:{page:"save-"+notify.type,hash:notify.hash,notifyData:n,publish:"true"},beforeSend:function(){buttonToPreloader($("#"+t),"green");$("#notificationedit").find("input,select,textarea").attr("disabled",true)},error:function(){showErrorMessage("Internal server error. Try again later",2e4)},success:function(e){l(e.data.json,function(){location.href=publishUrl})}})}}});return false};var h=NumericStepper.register("numeric-stepper",1,5,1);$.fn.defaultValues=function(){$(this).find(":input").each(function(){var e=$(this);var t=e.attr("data-default-text");if(t!="undefined"&&t!=undefined){if(e.val()==""){e.val(t)}}})};$.fn.applyPlaceholders=function(){$(this).find(":input").each(function(){var e=$(this);var t=e.attr("data-default-text");if(t!="undefined"&&t!=undefined){if(e.val()==""){e.val(t)}e.focus(function(){if(this.value==t){this.value=""}});e.blur(function(){if(this.value==""){this.value=t}})}})};p(3);$("#notificationedit .messagefield").not(".disabled").each(function(){g($(this))});$('input[type="radio"],.radioButtonLabel').click(function(){var e=$(this).hasClass("radioButtonLabel")?$(this).parent().find('input[type="radio"]'):$(this);e.attr({checked:true})});if(!isPublished){$("#notificationedit").defaultValues()}$("#message_type_twitter,#message_type_rss_feed").applyPlaceholders();var y={init:function(e){y.c={wrapper:"#initialWrapper",preview:"#livePreview",inner:"#livePreview #inner",holder:"#livePreview,#livePreview #inner",view:"#initialWrapper .NotifyButtons .view",edit:"#livePreview .NotifyButtons .edit",change:"#livePreview .NotifyButtons .blue",previewBttn:"#livePreview .NotifyButtons",wrapperBttn:"#initialWrapper .NotifyButtons"};$.extend(y.c,e);y.setup()},setup:function(){if(y.getCookie("preview")!=null){y.loadPreview(true)}$(y.c.view).unbind().bind("click",function(e){$.ajax({type:"post",data:{page:"save-"+notify.type,hash:notify.hash,notifyData:s()},complete:function(){y.setCookie("scroll",$(window).scrollTop());y.loadPreview(true);_gaq.push(["_trackEvent","Configurator","Preview On My Website"]);y.setCookie("preview","open")}});return false});$(y.c.edit).live("click",function(e){e.preventDefault();e.stopPropagation();removeLiveWidget();y.closePreview();y.setCookie("preview",null);return false});$(y.c.change).live("click",function(e){e.preventDefault();e.stopPropagation();y.dialogform(true);return false});y.bttnsVerticalAlign();$(window).resize(function(){y.bttnsVerticalAlign();$(y.c.holder).height($(window).height())})},setCookie:function(e,t){$.userApi.cookie("notificationBar_"+notify.hash+"_"+e,t)},getCookie:function(e){return $.userApi.cookie("notificationBar_"+notify.hash+"_"+e)},wrapper:function(e){var t=$("<div/>").attr({id:"inner"}).width("100%").height($(window).height()).css({"float":"left",position:"relative","overflow-x":"hidden","overflow-y":"visible"});var n=$("<div/>").attr({id:"livePreview"}).wrapInner(t);if(!e){$([]).add(n).add(t).css({backgroundColor:"#000"})}else{$([]).add(n).add(t).css({backgroundColor:""})}return n},notifyBttns:function(){return'<div class="NotifyButtons left" data-type="buttons">'+$(y.c.wrapperBttn).html()+"</div>"},dialogform:function(e){if(e=="undefined"){e=false}y.closeDialogs();if(!e){y.cleanPreview()}var t=$("<span/>").css({width:"530px",clear:"both",color:"red",fontStyle:"italic",display:"none"}).addClass("error").text("Please enter an URL address");var n=$("<input/>").attr({type:"text",name:"preview_url","data-default-text":"Enter your site URL or any URL where you would like to see this notification in action"}).css({width:"530px",padding:"6px 4px","float":"left"}).after(t);if(y.getCookie("url")!=null){n.val(y.getCookie("url"))}var r=$("<div/>").html(n).dialog({autoOpen:false,modal:true,height:170,width:600,title:"Preview URL",closeText:"Close X",closeOnEscape:false,open:function(e,t){$(this).bind("keypress keydown",function(e){var t=e.keyCode?e.keyCode:e.which?e.which:e.charCode;if(e.type=="keydown"&&t==13){$(".ui-dialog").find('button:contains("Done")').trigger("click")}});$(this).find("input").on("keyup",function(){if(this.value.length>0)$(this).css("color","#000");else $(this).css("color","")});$(".ui-dialog").applyPlaceholders();if($(this).find("input")[0].value.length>0&&$(this).find("input")[0].value!==$(this).find("input").attr("data-default-text"))$(this).find("input").css("color","#000");else $(this).find("input").css("color","");$(".ui-dialog").find('input[name="preview_url"]').blur();y.bttnsVerticalAlign();$(".ui-dialog").find("button").removeAttr("class");$(".ui-dialog").find("button:first").addClass("blue").css("margin-right",0);$(".ui-dialog").find("button:last").addClass("gray").css("float","right");$(".ui-dialog").find(".ui-dialog-buttonpane").css({"float":"right","margin-right":"30px","padding-right":0});$(".ui-dialog").find(".ui-dialog-titlebar-close").hide();$(".ui-dialog,.ui-corner-all,.ui-dialog button,.ui-dialog .ua-b").addClass("flat-dialog");$(".ui-dialog-buttonpane button").addClass("buttonh")},buttons:{Done:function(){var e=$(this).find('input[name="preview_url"]');var t=$(this).find(".error");t.hide();e.removeClass("focus");if(e.val()==""){e.addClass("focus");t.fadeIn()}else{y.setCookie("url",e.val());removeLiveWidget();y.loadIframe(e.val());$(this).dialog("close")}e.live("blur focus",function(){e.removeClass("focus");t.hide()})},Cancel:function(){$(this).dialog("close");if(y.getCookie("url")==null){y.setCookie("preview",null);y.closePreview()}}}});r.dialog("open");$(".ui-dialog-titlebar-close").click(function(){$(".ui-dialog").find("button:first").trigger("click")})},closeDialogs:function(){$(".ui-dialog-content").dialog("destroy");$(".ui-dialog-content").dialog("close");$(".ui-dialog-content").remove();$(".ui-dialog").remove()},preloader:function(){var e=$(window).width();var t=$(window).height();return $("<img/>").css({position:"relative",left:e/2-16,top:t/2-16}).attr({src:"/images/loader.gif",width:32,height:32}).addClass("loading")},loadIframe:function(e){var t=$(y.c.preview).find("#inner");if(!e.match(/http:\/\//)){e="http://"+e}t.find("iframe").remove();y.bttnsVerticalAlign();t.append(y.preloader());y.bttnsVerticalAlign();setTimeout(function(){t.find(".loading").remove();$("<iframe/>").width("100%").height("160%").css({margin:0,padding:0,border:0,backgroundColor:""}).attr({id:"load_content",scrolling:"no",frameborder:0,marginwidth:0,marginheight:0,vspace:0,hspace:0,width:"100%",height:"160%"}).src(e,function(){$(this).css({backgroundColor:"#fff"});removeLiveWidget();createLiveWidget();y.bttnsVerticalAlign()}).appendTo(t)},600)},cleanPreview:function(){var e=$(y.c.preview).find("#inner");e.find("iframe").remove();e.find(".loading").show(0)},loadPreview:function(e){var t=$(window).width(),n=$(window).height(),r=$(window).scrollTop();$(y.c.preview).remove();$("html,body").removeClass("oveflowhidden").addClass("oveflowhidden");$("body").append(y.wrapper(e));$(".NotifyButtons").hide(0);$(y.c.wrapper).height(n).css({overflow:"hidden"}).scrollTop(r);$(y.c.wrapper).stop(true,true).animate({left:"-"+t+"px"},400);$(y.c.preview).height(n).css({left:t+"px",overflow:"hidden"}).stop(true,true).animate({left:0},400,function(){var e=y.getCookie("url");$(this).append(y.notifyBttns());$(y.c.previewBttn).find(".v").hide(0);$(y.c.previewBttn).find(".u").show(0);if(e!=null){y.loadIframe(e)}else{y.dialogform()}})},closePreview:function(){var e=$(window).width();var t=y.getCookie("scroll");y.closeDialogs();$(y.c.wrapper).animate({left:0},400,function(){$(this).css({overflow:"hidden",height:"auto"})});$(y.c.previewBttn).remove();$(y.c.preview).animate({left:e+"px"},400,function(){$(this).remove();$("html,body").removeClass("oveflowhidden");$(window).scrollTop(t);$(y.c.wrapperBttn).show(0)})},bttnsVerticalAlign:function(){var e=$(window).height();$([]).add(y.c.wrapperBttn).add(y.c.previewBttn).each(function(){var t=$(this).height()/2;$(this).css({top:e/2-t+"px"})})}};y.init()});var NumericStepper={register:function(e,t,n,r){this.minValue=t;this.maxValue=n;this.stepSize=r;var i=getElementsByClassName(document,"*",e);for(var s=0;s<i.length;s++){var o=i[s].getElementsByTagName("input")[0];if(o){if(o.value==undefined||o.value==""||isNaN(o.value))o.value=0;o.onkeypress=function(e){if(window.event){keynum=e.keyCode}else if(e.which){keynum=e.which}keychar=String.fromCharCode(keynum);numcheck=/[0-9\-]/;if(keynum==8)return true;else return numcheck.test(keychar)};o.onblur=function(){if(parseInt(this.value)<NumericStepper.minValue)this.value=NumericStepper.minValue;if(parseInt(this.value)>NumericStepper.maxValue)this.value=NumericStepper.maxValue};var u=i[s].getElementsByTagName("button");if(u[0]){this.addButtonEvent(u[0],o,this.stepUp)}if(u[1])this.addButtonEvent(u[1],o,this.stepDown)}}},addButtonEvent:function(e,t,n){e.textbox=t;if(e.getAttribute("type")=="submit"){e.removeAttribute("type");e.setAttribute("type","button")}e.onclick=n},stepUp:function(){NumericStepper.stepper(this.textbox,NumericStepper.stepSize)},stepDown:function(){NumericStepper.stepper(this.textbox,-NumericStepper.stepSize)},stepper:function(e,t){if(e==undefined)return false;if(t==undefined||isNaN(t))t=1;if(e.value==undefined||e.value==""||isNaN(e.value))e.value=0;e.value=parseInt(e.value)+parseInt(t);if(parseInt(e.value)<NumericStepper.minValue)e.value=NumericStepper.minValue;if(parseInt(e.value)>NumericStepper.maxValue)e.value=NumericStepper.maxValue;return false}};(function(e){jQuery.fn.inputValidator=function(t){var n=e.extend({},e.fn.inputValidator.defaults,t);return this.each(function(){var t=e(this);var r=e.extend({},n);var i=typeof t.val==="function"?t.val().length:0;var s=t.val();if(e.inArray("digits",r.validators)!=-1){t.on("paste keyup",function(e){if(e.type=="paste"){var n=t.val();setTimeout(function(){var e=u(t.val());e=e==""?n:e;t.val(e)},100)}else{var r=u(t.val());var i=parseInt(e.keyCode?e.keyCode:e.which);if(i!==37||i!==39){t.val(r)}}})}var o=function(){t.one("keydown",function(e){s=t.val()})};o();t.on("paste keyup",function(e){var n=parseInt(e.keyCode?e.keyCode:e.which);if(n!==37||n!==39){t.val(a(t.val(),s,r.limit))}o();if(e.type=="paste"){s=t.val()}});var u=function(e){var t=new String(e);t=t.replace(/[^0-9]/g,"");return t};var a=function(e,t,n){var r=new String(e);i=r.length;if(i>n){i=n;if(t!=""){r=t}else{r=r.slice(0,n)}}return r}})};jQuery.fn.inputValidator().defaults={validators:[],limit:500}})(jQuery);